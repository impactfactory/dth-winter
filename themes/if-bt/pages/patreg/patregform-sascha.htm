title = "Patienten-Registration"
url = "/stammblatt"
layout = "default"
meta_title = "Patienten-Registration"
meta_description = "Übermitteln Sie uns Ihre Stammdaten vor Ihrem ersten Termin bei uns."
is_hidden = 0
robot_index = "noindex"
robot_follow = "nofollow"
og_title = "Patienten-Registration/Stammblatt"
og_type = "article"
og_description = "Übermitteln Sie uns Ihre Stammdaten vor Ihrem ersten Termin bei uns."

[patregassurances]
==
<?php

use ImpactFactory\Patreg\Models\Patients;
use RainLab\Translate\Models\Message;
use Mail;
use Input;

function onHandleForm()
  {
    
      /*
      $item = new Patients(Input::all);
      $item->created_at = Carbon\Carbon::now();
      $item->customMessages = [
        'firstname.required' => Message::trans('patreg.errors.firstname_required'),
       
        'doc_email.required' => Message::trans('patreg.errors.doc_email_required'),
        'doc_phone.required' => Message::trans('repatregf.errors.doc_phone_required'),
        'doc_email.email' => Message::trans('patreg.errors.doc_email_email'),
        'doc_email.required' => Message::trans('patreg.errors.doc_email_required'),
        'doc2_email.email' => Message::trans('patreg.errors.doc2_email_email'),
        'email.email' => Message::trans('patreg.errors.email_email'),
        'email.required' => Message::trans('patreg.errors.email_required'),
        'phone.required' => Message::trans('patreg.errors.phone_required'),
        'firstname.required' => Message::trans('patreg.errors.firstname_required'),
        'lastname.required' => Message::trans('patreg.errors.lastname_required'),
        'question.max' => Message::trans('patreg.errors.question_max'),
        'clinical.max' => Message::trans('patreg.errors.clinical_max'),
        'note.max' => Message::trans('patreg.errors.note_max')
       
      ];
      //$item->save();
    */

      //Send Mails
      $vars = [
          'created_at' => Carbon\Carbon::now(),
          'firstname' => Input::get('firstname'),
          'lastname' => Input::get('lastname')
      ];

      Mail::send('if.forms::patreg.data', $vars, function($message) {
        $message->to('tec@dth-herzzentrum.ch', 'Diagnostisches und Therapeutisches Herzzentrum AG');
        $message->from('dth-admin@hin.ch', 'Diagnostisches und Therapeutisches Herzzentrum AG');
      });

      $this['sent'] = true;

      // Success Message for User
      Flash::success(Message::trans('patreg.flashmessage'));

      // Redirect after Success Message
      return Redirect::to('/stammblatt');
  }
?>
==
<section id="patregform" class="fullwrap">
    <div class="indent-me">

        {% content 'stammblatt-intro' %}

        <form class="p-3" novalidate data-request="onHandleForm" data-request-files data-request-validate
            data-request-flash>

            <div class="row">
                <div class="col-12 pt-3 ">

                    <div class="alert alert-danger" data-validate-error>
                        <p data-message></p>
                    </div>

                    {# Tab Navigation #}
                    <ul class="nav nav-tabs" id="FormsTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="patient-tab" data-bs-toggle="tab"
                                data-bs-target="#patient" type="button" role="tab" aria-controls="patient"
                                aria-selected="true">
                                1 {% partial 'html_body/svg-icons/arrow-circle-right' %}
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact"
                                type="button" role="tab" aria-controls="contact" aria-selected="false">
                                2 {% partial 'html_body/svg-icons/arrow-circle-right' %}
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="ass-tab" data-bs-toggle="tab" data-bs-target="#ass"
                                type="button" role="tab" aria-controls="ass" aria-selected="false">
                                3 {% partial 'html_body/svg-icons/arrow-circle-right' %}
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="doctors-tab" data-bs-toggle="tab" data-bs-target="#doctors"
                                type="button" role="tab" aria-controls="doctors" aria-selected="false">
                                4 {% partial 'html_body/svg-icons/arrow-circle-right' %}
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="drugs-tab" data-bs-toggle="tab" data-bs-target="#drugs"
                                type="button" role="tab" aria-controls="drugs" aria-selected="false">
                                5 {% partial 'html_body/svg-icons/arrow-circle-right' %}
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="allergies-tab" data-bs-toggle="tab" data-bs-target="#allergies"
                                type="button" role="tab" aria-controls="allergies" aria-selected="false">
                                6 {% partial 'html_body/svg-icons/arrow-circle-right' %}
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="consent-tab" data-bs-toggle="tab" data-bs-target="#consent"
                                type="button" role="tab" aria-controls="consent" aria-selected="false">
                                7 {% partial 'html_body/svg-icons/check-circle' %}
                            </button>
                        </li>
                    </ul>

                    {# Tab Patient #}
                    <div class="tab-pane fade show" id="patient" role="tabpanel" aria-labelledby="patient-tab">
                        <div class="row col-12 pt-2">
                            <div class="col-12 col-md-6 mb-3 col-4">
                                <label for="gender">{{ 'forms.patreg.label.gender'|_ }} *</label>
                                <select id="gender" class="form-select" aria-label="gender select" name="gender"
                                    required>
                                    {% if warnings %}
                                    <option value="{{gender}}" selected>{{gender}}</option>
                                    {% else %}
                                    <option value="" selected>bitte wählen...</option>
                                    {% endif %}
                                    <option value="Herr">{{ 'forms.patreg.gender.option.m'|_ }}</option>
                                    <option value="Frau">{{ 'forms.patreg.gender.option.f'|_ }}</option>
                                    <option value="divers">{{ 'forms.patreg.gender.option.q'|_ }}</option>
                                </select>
                            </div>

                            <div
                                class="col-12 col-md-6 mb-3 col-4 {% if warnings.first('firstname') %}error{% endif %}">
                                <label for="firstname">{{ 'forms.patreg.label.firstname'|_ }} *</label>
                                <input type="text" id="firstname" name="firstname" class="form-control"
                                    value="{{firstname}}" required>
                                {% if warnings.first('firstname') %}
                                <div class="form-text text-danger">{{regex1message}}</div>
                                {% endif %}

                            </div>

                            <div class="col-12 col-md-6 mb-3 col-4 {% if warnings.first('lastname') %}error{% endif %}">
                                <label for="lastname">{{ 'forms.patreg.label.lastname'|_ }} *</label>
                                <input type="text" id="lastname" name="lastname" class="form-control"
                                    value="{{lastname}}" required>
                                {% if warnings.first('lastname') %}
                                <div class="form-text text-danger">{{regex1message}}</div>
                                {% endif%}
                            </div>

                            <div class="col-12 col-md-6 mb-3 col-4 {% if warnings.first('streetno') %}error{% endif %}">
                                <label for="streetno">{{ 'forms.patreg.label.streetno'|_ }} *</label>
                                <input type="text" id="streetno" name="streetno" class="form-control" required>
                                {% if warnings.first('streetno') %}
                                <div class="form-text text-danger">{{regex2message}}</div>
                                {% endif%}
                            </div>

                            <div class="col-12 col-md-6 mb-3 col-4 {% if warnings.first('zip') %}error{% endif %}">
                                <label for="zip">{{ 'forms.patreg.label.zip'|_ }} *</label>
                                <input type="number" id="zip" name="zip" class="form-control" required>
                            </div>

                            <div class="col-12 col-md-6 mb-3 col-4 {% if errors.first('city') %}error{% endif %}">
                                <label for="city">{{ 'forms.patreg.label.location'|_ }} *</label>
                                <input type="text" id="city" name="city" class="form-control" required>
                            </div>

                            <div class="col-12 col-md-6 mb-3 col-4 {% if errors.first('country') %}error{% endif %}">
                                <label for="country">{{ 'forms.patreg.label.country'|_ }} *</label>
                                <select id="country" class="form-select" aria-label="" name="country" required>
                                    <option value="" selected>bitte wählen...</option>
                                    <option value="Schweiz">Schweiz</option>
                                    <option value="Deutschland">Deutschland</option>
                                </select>
                            </div>

                            <div class="col-12 col-md-6 mb-3 col-4 {% if errors.first('phone') %}error{% endif %}">
                                <label for="phone">{{ 'forms.patreg.label.phone'|_ }} *</label>
                                <input type="number" id="phone" name="phone" class="form-control" required>
                            </div>

                            <div class="col-12 col-md-6 mb-3 col-4 {% if errors.first('mail') %}error{% endif %}">
                                <label for="email">{{ 'forms.patreg.label.email'|_ }} *</label>
                                <input type="email" id="email" name="email" class="form-control" required>
                                <div class="form-text text-danger">{{regex3message}}</div>
                            </div>

                            <div class="col-12 col-md-6 mb-3 col-4 {% if errors.first('birthday') %}error{% endif %}">
                                <label for="birthday">{{ 'forms.patreg.label.birthday'|_ }} *</label>
                                <input type="date" id="birthday" name="birthday" class="form-control" min="1910-01-01"
                                    max="{{ 'now' | date('Y-m-d') }}" required>
                            </div>

                            <div
                                class="col-12 col-md-6 mb-3 col-4 {% if errors.first('civilianstatus') %}error{% endif %}">
                                <label for="civilianstatus">{{ 'forms.patreg.label.civilianstatus'|_ }} *</label>
                                <select id="civilianstatus" class="form-select" aria-label="" name="civilianstatus"
                                    required>
                                    {% if warnings %}
                                    <option value="{{civilianstatus}}" selected>{{civilianstatus}}</option>
                                    {% else %}
                                    <option value="" selected>bitte wählen...</option>
                                    {% endif %}
                                    <option value="ledig/unverheiratet">ledig/unverheiratet</option>
                                    <option value="verheiratet">verheiratet</option>
                                    <option value="in eingetragener Partnerschaft">in eingetragener Partnerschaft
                                    </option>
                                    <option value="geschieden">geschieden</option>
                                    <option value="in ausgetragener Partnerschaft">in ausgetragener Partnerschaft
                                    </option>
                                    <option value="verwitwet">verwitwet</option>
                                </select>
                            </div>

                            <div class="col-12 col-md-6 mb-3 col-4 {% if errors.first('encryption') %}error{% endif %}">
                                <label for="encryption">{{ 'forms.patreg.label.encryption'|_ }} *</label>
                                <select id="encryption" class="form-select" aria-label="" name="encryption" required>
                                    {% if warnings %}
                                    <option value="{{encryption}}" selected>{{encryption}}</option>
                                    {% else %}
                                    <option value="" selected>bitte wählen...</option>
                                    {% endif %}
                                    <option value="verschlüsselt">verschlüsselt</option>
                                    <option value="unverschlüsselt">unverschlüsselt</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    {# Tab Contact #}
                    <div class="tab-pane fade show" id="contact" role="tabpanel" aria-labelledby="contact-tab">
                        <div class="row col-12">
                            Contact
                        </div>
                    </div>

                    {# Tab Assurances #}
                    <div class="tab-pane fade show" id="ass" role="tabpanel" aria-labelledby="ass-tab">
                        <div class="row col-12">
                            Assurances
                            {% component 'patregassurances' %}
                        </div>
                    </div>

                    {# Tab Doctors #}
                    <div class="tab-pane fade show" id="doctors" role="tabpanel" aria-labelledby="doctors-tab">
                        <div class="row col-12">
                            Doctors
                        </div>
                    </div>

                    {# Tab Drugs #}
                    <div class="tab-pane fade show" id="drugs" role="tabpanel" aria-labelledby="drugs-tab">
                        <div class="row col-12">
                            Drugs
                        </div>
                    </div>

                    {# Tab Allergies #}
                    <div class="tab-pane fade show" id="allergies" role="tabpanel" aria-labelledby="allergies-tab">
                        <div class="row col-12">
                            Allergies
                        </div>
                    </div>

                    {# Tab Consent #}
                    <div class="tab-pane fade show" id="consent" role="tabpanel" aria-labelledby="consent-tab">
                        <div class="row col-12">
                            Consent and submit

                            {# Submit Section #}
                            <div class="col-12 text-center pt-3">
                                <button id="submit" name="submit" type="submit" class="btn btn-lg btn-primary"
                                    data-attach-loading>
                                    {{ 'forms.patreg.label.submit'|_ }}
                                </button>
                            </div>
                        </div>
                    </div>






                </div>
            </div> {# end row #}
        </form>
    </div> {# end indent-me #}
</section>

{% put scripts %}

<script>
    $(window).on('ajaxInvalidField', function (event, fieldElement, fieldName, errorMsg, isFirst) {
        $(fieldElement).closest('.form-control').addClass('is-invalid');
    });

    $(document).on('ajaxPromise', '[data-request]', function () {
        $(this).closest('form').find('.form-control.is-invalid').removeClass('is-invalid');
    });
</script>

{% endput %}